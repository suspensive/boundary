import { Callout } from '@/components'

# QueryClientConsumer

React hook의 제약을 피해 JSX 상에서 useQueryClient를 사용할 수 있게 하는 컴포넌트입니다. 컴포넌트 형태를 통해 레거시 클래스 컴포넌트나 특정 환경(SSR, 마이크로 프론트엔드)에서 선언적으로 QueryClient에 접근할 수 있도록 도와줍니다.

```jsx /QueryClientConsumer/
import { QueryClientConsumer, useSuspenseQuery } from '@suspensive/react-query'

const PostsPage = () => {
  const { data: posts } = useSuspenseQuery({
    queryKey: ['posts'],
    queryFn: () => getPosts(),
  })

  return (
    <>
      <QueryClientConsumer>
        {(queryClient) => (
          <button
            onClick={() =>
              queryClient.invalidateQueries({
                queryKey: ['posts'],
              })
            }
          >
            Posts refresh
          </button>
        )}
      </QueryClientConsumer>
      {posts.map((post) => (
        <Post key={post.id} {...post} />
      ))}
    </>
  )
}
```

### 동기

React의 훅(useQueryClient)은 함수형 컴포넌트에서만 사용할 수 있습니다. 하지만 레거시 클래스 컴포넌트에서도 쿼리 무효화(invalidateQueries)와 같은 기능이 필요할 때가 있습니다. 이때 QueryClientConsumer를 사용하면 이러한 제약을 해결할 수 있습니다.

```tsx /QueryClientConsumer/
import React, { Component } from 'react'
import { QueryClientConsumer } from '@suspensive/react-query'

class PostsRefreshButton extends Component {
  render() {
    return (
      <QueryClientConsumer>
        {(queryClient) => (
          <button
            onClick={() =>
              queryClient.invalidateQueries({
                queryKey: ['posts'],
              })
            }
          >
            Posts refresh
          </button>
        )}
      </QueryClientConsumer>
    )
  }
}

export default PostsRefreshButton
```
